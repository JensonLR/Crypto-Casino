<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Crypto Casino - Meme Coin Madness</title>
  <style>
    body {
      background-color: #111;
      color: #fff;
      font-family: 'Arial', sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1, h2, p {
      margin: 10px;
    }
    .container {
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background: #222;
      border-radius: 10px;
      box-shadow: 0 0 20px #ff00ff;
    }
    button {
      background: #ff0066;
      color: #fff;
      padding: 10px 20px;
      border: none;
      cursor: pointer;
      margin: 5px;
      font-size: 16px;
      border-radius: 5px;
    }
    button:hover {
      background: #ff3388;
    }
    input[type="number"],
    input[type="text"] {
      padding: 8px;
      border-radius: 5px;
      border: none;
      margin: 5px;
      font-size: 16px;
    }
    #solBalance {
      position: fixed;
      top: 10px;
      right: 10px;
      background: #ff0066;
      color: #000;
      padding: 10px;
      border-radius: 5px;
      font-size: 18px;
    }
    /* Roulette Table Styling */
    .roulette-table {
      margin: 20px auto;
      display: grid;
      grid-template-columns: repeat(4, 60px);
      gap: 10px;
      justify-content: center;
    }
    .roulette-bet {
      background: #222;
      border: 2px solid #ff0066;
      border-radius: 5px;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 60px;
      height: 60px;
      cursor: pointer;
    }
    .roulette-bet:hover {
      background: #ff3388;
    }
    .roulette-wheel {
      width: 150px;
      height: 150px;
      border: 5px solid #fff;
      border-radius: 50%;
      margin: 20px auto;
      transition: transform 2s ease-out;
      background: radial-gradient(circle, red, black);
    }
    /* Blackjack Styling */
    .blackjack-cards {
      font-size: 24px;
      margin-top: 10px;
      min-height: 50px;
    }
    .card {
      margin: 10px;
      display: inline-block;
      font-size: 32px;
      padding: 10px;
      border: 2px solid #ff0066;
      border-radius: 5px;
      background: #333;
    }
    .hit-stick {
      margin-top: 20px;
    }
    /* Leaderboard Styling */
    .leaderboard {
      margin-top: 20px;
      background: #333;
      padding: 10px;
      border-radius: 10px;
    }
  </style>
</head>
<body>

  <!-- Name Entry Section -->
  <div id="nameEntry" class="container">
    <h1>Welcome to Crypto Casino üé∞</h1>
    <p>The world‚Äôs biggest casino where meme coins make you a degen legend!</p>
    <p>Enter your name to stake your claim and join the elite club:</p>
    <input type="text" id="playerName" placeholder="Your Name" />
    <button onclick="saveName()">Start Playing</button>
  </div>

  <!-- Main Casino Section -->
  <div id="casinoSection" style="display:none;">
    <h1>Crypto Casino üé∞</h1>
    <p><strong>Memecoin Contract Address:</strong> <span id="ca">[Insert Your CA]</span></p>
    <div id="solBalance">SOL: 100</div>

    <!-- Roulette Section -->
    <div class="container" id="rouletteSection">
      <h2>Roulette üé°</h2>
      <p>Place your bets on numbers, colors, odd or even ‚Äì stack 'em up degen style!</p>
      <div class="roulette-wheel" id="rouletteWheel"></div>
      <div class="roulette-table" id="rouletteTable">
        <!-- For demonstration, we'll show numbers 0 to 12 -->
        <div class="roulette-bet" onclick="placeRouletteBet('0')">0</div>
        <div class="roulette-bet" onclick="placeRouletteBet('1')">1</div>
        <div class="roulette-bet" onclick="placeRouletteBet('2')">2</div>
        <div class="roulette-bet" onclick="placeRouletteBet('3')">3</div>
        <div class="roulette-bet" onclick="placeRouletteBet('4')">4</div>
        <div class="roulette-bet" onclick="placeRouletteBet('5')">5</div>
        <div class="roulette-bet" onclick="placeRouletteBet('6')">6</div>
        <div class="roulette-bet" onclick="placeRouletteBet('7')">7</div>
        <div class="roulette-bet" onclick="placeRouletteBet('8')">8</div>
        <div class="roulette-bet" onclick="placeRouletteBet('9')">9</div>
        <div class="roulette-bet" onclick="placeRouletteBet('10')">10</div>
        <div class="roulette-bet" onclick="placeRouletteBet('11')">11</div>
        <div class="roulette-bet" onclick="placeRouletteBet('12')">12</div>
        <!-- Additional betting areas -->
        <div class="roulette-bet" onclick="placeRouletteBet('red')">Red</div>
        <div class="roulette-bet" onclick="placeRouletteBet('black')">Black</div>
        <div class="roulette-bet" onclick="placeRouletteBet('odd')">Odd</div>
        <div class="roulette-bet" onclick="placeRouletteBet('even')">Even</div>
      </div>
      <button onclick="spinRoulette()">Spin the Wheel</button>
      <p id="rouletteResult">Place your bets!</p>
      <button onclick="clearRouletteBets()">Clear Bets</button>
    </div>

    <!-- Blackjack Section -->
    <div class="container" id="blackjackSection">
      <h2>Blackjack üÉè</h2>
      <p>Bet big, hit or stick ‚Äì beat the dealer and rule the table!</p>
      <p>
        Bet Amount (SOL): <input type="number" id="bjBet" min="1" placeholder="Bet" />
        <button onclick="startBlackjack()">Deal Cards</button>
      </p>
      <div class="blackjack-cards" id="playerCards"></div>
      <div class="blackjack-cards" id="dealerCards"></div>
      <div class="hit-stick" id="bjControls" style="display:none;">
        <button onclick="hit()">Hit</button>
        <button onclick="stick()">Stick</button>
      </div>
      <p id="blackjackResult">Waiting for your move...</p>
    </div>

    <!-- Leaderboard Section -->
    <div class="leaderboard container" id="leaderboardSection">
      <h2>Leaderboard üèÜ</h2>
      <p>Only real degen names allowed ‚Äì track your win/loss relative to your starting 100 SOL.</p>
      <ul id="leaderboard"></ul>
    </div>
  </div>

  <script>
    /**********************
     * GLOBAL VARIABLES
     **********************/
    let solBalance = 100;
    let playerName = "";
    // Clear old leaderboard data on new session
    localStorage.removeItem("leaderboard");
    let leaderboard = [];
    
    // Roulette bets: array of { betType, amount }
    let rouletteBets = [];
    
    // Blackjack variables
    let bjDeck = [];
    let playerHand = [];
    let dealerHand = [];
    let currentBJBet = 0;
    let inBlackjackGame = false;
    
    /**********************
     * HELPER FUNCTIONS
     **********************/
    
    // Utility: Shuffle an array (Fisher-Yates)
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }
    
    // Create and shuffle a deck of cards
    function createDeck() {
      const suits = ['‚ô†', '‚ô•', '‚ô¶', '‚ô£'];
      const ranks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
      let deck = [];
      for (let suit of suits) {
        for (let rank of ranks) {
          let value = 0;
          if (rank === 'A') value = 11;
          else if (['J', 'Q', 'K'].includes(rank)) value = 10;
          else value = parseInt(rank);
          deck.push({ suit, rank, value });
        }
      }
      return shuffle(deck);
    }
    
    // Calculate blackjack hand total (handle Aces as 11 or 1)
    function calculateHand(hand) {
      let total = hand.reduce((sum, card) => sum + card.value, 0);
      let aces = hand.filter(card => card.rank === 'A').length;
      while (total > 21 && aces > 0) {
        total -= 10;
        aces--;
      }
      return total;
    }
    
    /**********************
     * NAME & LEADERBOARD
     **********************/
    function saveName() {
      playerName = document.getElementById("playerName").value.trim();
      if (playerName) {
        // Reset balance and leaderboard for a new session
        solBalance = 100;
        localStorage.setItem("solBalance", solBalance);
        leaderboard = [];
        updateBalance();
        updateLeaderboard();
        document.getElementById("nameEntry").style.display = "none";
        document.getElementById("casinoSection").style.display = "block";
      }
    }
    
    function updateBalance() {
      document.getElementById("solBalance").textContent = `SOL: ${solBalance}`;
    }
    
    function updateLeaderboard() {
      // For this session, leaderboard holds only players who entered their name.
      // We push/update the current player‚Äôs record.
      const existing = leaderboard.find(entry => entry.name === playerName);
      if (existing) {
        existing.score = solBalance;
      } else {
        leaderboard.push({ name: playerName, score: solBalance });
      }
      // Display leaderboard
      let list = document.getElementById("leaderboard");
      list.innerHTML = leaderboard
        .map((entry, i) => {
          let diff = entry.score - 100;
          return `<li>${i + 1}. ${entry.name}: ${entry.score} SOL (${diff >= 0 ? '+' : ''}${diff})</li>`;
        })
        .join("");
    }
    
    /**********************
     * ROULETTE FUNCTIONS
     **********************/
    
    // When user clicks on a bet zone
    function placeRouletteBet(betType) {
      let amount = parseInt(prompt(`Place your bet for ${betType} (Enter SOL amount):`));
      if (isNaN(amount) || amount <= 0) {
        alert("Invalid bet amount.");
        return;
      }
      if (amount > solBalance) {
        alert("Not enough SOL for that bet.");
        return;
      }
      // Deduct bet amount immediately
      solBalance -= amount;
      updateBalance();
      // Add bet to array
      rouletteBets.push({ betType, amount });
      alert(`Bet placed: ${amount} SOL on ${betType}.`);
    }
    
    function spinRoulette() {
      if (rouletteBets.length === 0) {
        alert("Place at least one bet first!");
        return;
      }
      // Spin animation
      animateRoulette();
      // Wait for animation to complete (2s)
      setTimeout(() => {
        // Outcome: random number 0-36
        const outcome = Math.floor(Math.random() * 37);
        const outcomeColor = getRouletteColor(outcome);
        let totalWin = 0;
        let resultMessage = `Outcome: ${outcome} (${outcomeColor}). `;
    
        // Evaluate each bet
        rouletteBets.forEach(bet => {
          let win = false;
          let payout = 0;
          if (!isNaN(bet.betType)) {
            // Bet on a specific number
            if (parseInt(bet.betType) === outcome) {
              win = true;
              payout = bet.amount * 35;
            }
          } else if (bet.betType === "red" || bet.betType === "black") {
            if (bet.betType === outcomeColor) {
              win = true;
              payout = bet.amount * 1;
            }
          } else if (bet.betType === "odd" || bet.betType === "even") {
            if (outcome === 0) win = false;
            else if (bet.betType === "odd" && outcome % 2 === 1) {
              win = true;
              payout = bet.amount * 1;
            } else if (bet.betType === "even" && outcome % 2 === 0) {
              win = true;
              payout = bet.amount * 1;
            }
          }
          if (win) {
            totalWin += payout + bet.amount; // return stake plus winnings
          }
        });
    
        // Return winnings or lose bets
        if (totalWin > 0) {
          solBalance += totalWin;
          resultMessage += `You won ${totalWin} SOL on your bets!`;
        } else {
          resultMessage += "No wins this spin.";
        }
    
        document.getElementById("rouletteResult").textContent = resultMessage;
        // Clear bets
        rouletteBets = [];
        updateBalance();
        updateLeaderboard();
      }, 2200);
    }
    
    function animateRoulette() {
      let wheel = document.getElementById("rouletteWheel");
      let rotation = Math.floor(Math.random() * 360) + 720;
      wheel.style.transform = `rotate(${rotation}deg)`;
    }
    
    // European Roulette color mapping for 0-36
    function getRouletteColor(num) {
      if (num === 0) return "green";
      const redNumbers = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
      return redNumbers.includes(num) ? "red" : "black";
    }
    
    function clearRouletteBets() {
      // Refund bets
      rouletteBets.forEach(bet => {
        solBalance += bet.amount;
      });
      rouletteBets = [];
      updateBalance();
      alert("All roulette bets cleared.");
    }
    
    /**********************
     * BLACKJACK FUNCTIONS
     **********************/
    
    function startBlackjack() {
      if (inBlackjackGame) {
        alert("Finish the current game first!");
        return;
      }
      let betInput = document.getElementById("bjBet").value;
      currentBJBet = parseInt(betInput);
      if (isNaN(currentBJBet) || currentBJBet <= 0) {
        alert("Enter a valid bet amount for Blackjack.");
        return;
      }
      if (currentBJBet > solBalance) {
        alert("Not enough SOL for that bet.");
        return;
      }
      solBalance -= currentBJBet;
      updateBalance();
      // Initialize deck and hands
      bjDeck = createDeck();
      playerHand = [];
      dealerHand = [];
      // Deal initial cards: two to player, two to dealer (one hidden)
      playerHand.push(bjDeck.pop());
      playerHand.push(bjDeck.pop());
      dealerHand.push(bjDeck.pop());
      dealerHand.push(bjDeck.pop());
      inBlackjackGame = true;
      // Display cards: dealer shows first card only
      displayBlackjackHands(false);
      document.getElementById("blackjackResult").textContent = "Choose: Hit or Stick?";
      document.getElementById("bjControls").style.display = "block";
    }
    
    function displayBlackjackHands(revealDealer) {
      let playerHTML = "Your Cards: ";
      playerHand.forEach(card => {
        playerHTML += `<span class="card">${card.rank}${card.suit}</span>`;
      });
      document.getElementById("playerCards").innerHTML = playerHTML;
    
      let dealerHTML = "Dealer's Cards: ";
      if (revealDealer) {
        dealerHand.forEach(card => {
          dealerHTML += `<span class="card">${card.rank}${card.suit}</span>`;
        });
      } else {
        dealerHTML += `<span class="card">${dealerHand[0].rank}${dealerHand[0].suit}</span>`;
        dealerHTML += `<span class="card">[Hidden]</span>`;
      }
      document.getElementById("dealerCards").innerHTML = dealerHTML;
    }
    
    function hit() {
      if (!inBlackjackGame) return;
      playerHand.push(bjDeck.pop());
      displayBlackjackHands(false);
      let playerTotal = calculateHand(playerHand);
      if (playerTotal > 21) {
        endBlackjack(false, `Busted at ${playerTotal}! You lose ${currentBJBet} SOL.`);
      } else {
        document.getElementById("blackjackResult").textContent = `Your total is ${playerTotal}. Hit or Stick?`;
      }
    }
    
    function stick() {
      if (!inBlackjackGame) return;
      // Reveal dealer's hidden card and have dealer hit until at least 17
      displayBlackjackHands(true);
      let dealerTotal = calculateHand(dealerHand);
      while (dealerTotal < 17) {
        dealerHand.push(bjDeck.pop());
        dealerTotal = calculateHand(dealerHand);
        displayBlackjackHands(true);
      }
      let playerTotal = calculateHand(playerHand);
      if (dealerTotal > 21 || playerTotal > dealerTotal) {
        endBlackjack(true, `You win! Your ${playerTotal} beats dealer's ${dealerTotal}. You win ${currentBJBet} SOL.`);
      } else if (playerTotal === dealerTotal) {
        // Push: refund bet
        solBalance += currentBJBet;
        endBlackjack(null, `Push! Both scored ${playerTotal}. Bet refunded.`);
      } else {
        endBlackjack(false, `Dealer wins with ${dealerTotal} vs your ${playerTotal}. You lose ${currentBJBet} SOL.`);
      }
    }
    
    function endBlackjack(win, message) {
      inBlackjackGame = false;
      document.getElementById("bjControls").style.display = "none";
      if (win === true) {
        solBalance += currentBJBet * 2; // win: receive double your bet
      }
      // No refund if lost (win === false); push already refunded above
      updateBalance();
      document.getElementById("blackjackResult").textContent = message;
      updateLeaderboard();
    }
    
    /**********************
     * INITIALIZATION
     **********************/
    if (localStorage.getItem("playerName")) {
      // If a name exists in storage, force re-entry for a fresh session.
      localStorage.removeItem("playerName");
    }
  </script>

</body>
</html>
